<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eko-LÄ°G: Sosyal Tasarruf PortalÄ± (TÃœBÄ°TAK 2204-C Demo)</title>
    <style>
        :root { --ana: #27ae60; --uyari: #e67e22; --hata: #e74c3c; --zemin: #f1f5f9; --koyu: #1e293b; --mavi: #3498db; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--zemin); margin: 0; padding: 15px; display: flex; justify-content: center; }
        .konteynir { width: 100%; max-width: 1100px; background: white; border-radius: 25px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); padding: clamp(15px, 4vw, 30px); position: relative; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(360px, 1fr)); gap: 25px; margin-top: 20px; }
        .kart { border: 1px solid #e2e8f0; border-radius: 18px; padding: 20px; background: #fff; position: relative; box-shadow: 0 4px 6px rgba(0,0,0,0.02); }
        h1 { color: var(--ana); text-align: center; border-bottom: 3px solid var(--ana); padding-bottom: 10px; margin-bottom: 25px; }
        h3 { border-left: 5px solid var(--ana); padding-left: 12px; color: var(--koyu); margin: 0 0 15px 0; font-size: 1.1rem; }
        .grup-ust-alan { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .btn-grup-ekle { background: #f1f5f9; border: 1px solid #cbd5e1; color: var(--koyu); padding: 8px 12px; border-radius: 10px; cursor: pointer; font-size: 0.8rem; font-weight: bold; white-space: nowrap; transition: 0.3s; }
        .btn-grup-ekle:hover { background: var(--ana); color: white; border-color: var(--ana); }
        .fatura-kontrol { display: flex; gap: 8px; margin-bottom: 15px; }
        .btn-tarat { flex: 1; background: #fff; color: var(--mavi); border: 1.5px dashed var(--mavi); padding: 10px; border-radius: 12px; cursor: pointer; font-size: 0.8rem; font-weight: bold; transition: 0.2s; }
        input, select { width: 100%; padding: 12px; margin: 5px 0 10px 0; border: 1.5px solid #cbd5e1; border-radius: 12px; box-sizing: border-box; font-size: 0.95rem; }
        .uclu { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        label { font-size: 0.75rem; color: #64748b; font-weight: bold; margin-left: 5px; }
        .tutorial-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1000; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .tutorial-kart { background: white; padding: 30px; border-radius: 20px; max-width: 420px; text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.3); }
        .tutorial-adim { font-weight: bold; color: var(--ana); margin-bottom: 10px; display: block; font-size: 1.2rem; }
        .tutorial-btn { background: var(--ana); color: white; border: none; padding: 14px 25px; border-radius: 10px; cursor: pointer; margin-top: 20px; width: 100%; font-weight: bold; font-size: 1rem; }
        .rozet-alani { display: flex; gap: 8px; margin-top: 10px; flex-wrap: wrap; }
        .rozet { padding: 8px 14px; border-radius: 20px; font-size: 0.75rem; background: #f1f5f9; color: #94a3b8; border: 1px solid #e2e8f0; opacity: 0.5; }
        .rozet.aktif { background: #dcfce7; color: #166534; border-color: #22c55e; font-weight: bold; opacity: 1; transform: scale(1.05); }
        .btn { border: none; padding: 18px; width: 100%; border-radius: 15px; font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 1rem; }
        .btn-ana { background: var(--ana); color: white; margin-top: 15px; box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3); }
        .btn-kaydet { background: var(--uyari); color: white; display: none; margin-top: 25px; animation: pulse 2s infinite; }
        .lig-item { display: flex; justify-content: space-between; padding: 12px; border-bottom: 1px solid #f1f5f9; font-size: 0.9rem; align-items: center; }
        .user-sira { background: #fff3e0; border: 2px solid var(--uyari); border-radius: 15px; font-weight: bold; color: #d35400; margin: 10px 0; }
        .market-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .m-kart { background: #f8fafc; padding: 12px; border-radius: 15px; text-align: center; border: 1px solid #e2e8f0; font-size: 0.85rem; }
        .m-btn { width: 100%; border: none; padding: 8px; border-radius: 8px; font-size: 0.7rem; margin-top: 8px; cursor: pointer; font-weight: bold; }
        .m-aktif { background: var(--ana); color: white; }
        .m-pasif { background: #e2e8f0; color: #94a3b8; }
        #sonuc-paneli { display: none; text-align: center; margin-bottom: 25px; padding: 20px; border-radius: 20px; border: 3px solid #eee; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

<div id="tutorial" class="tutorial-overlay">
    <div class="tutorial-kart">
        <span class="tutorial-adim" id="adimNo">AdÄ±m 1 / 3</span>
        <h2 id="adimBaslik">HoÅŸ Geldiniz! ğŸŒ±</h2>
        <p id="adimAciklama">Eko-LÄ°G ile enerji tasarrufunu eÄŸlenceye dÃ¶nÃ¼ÅŸtÃ¼rÃ¼n. Ã–nce bilgilerinizi girin ve rekabet edeceÄŸiniz grubunuzu seÃ§in.</p>
        <button class="tutorial-btn" onclick="sonrakiAdim()">Sonraki</button>
    </div>
</div>

<div class="konteynir">
    <h1>ğŸŒ± EKO-LÄ°G TASARRUF PORTALI</h1>
    <div class="grid">
        <div class="panel">
            <div class="kart">
                <h3>ğŸ‘¤ KatÄ±lÄ±mcÄ± Bilgileri</h3>
                <label>Rumuz</label>
                <input type="text" id="rumuz" placeholder="Ã–rn: TasarrufCan_43">
                <div class="grup-ust-alan">
                    <label style="margin:0; flex-grow:1;">YarÄ±ÅŸma Grubu</label>
                    <button class="btn-grup-ekle" onclick="yeniGrupEkle()">+ Grup OluÅŸtur</button>
                </div>
                <select id="grupSecimi" onchange="ligiGuncelle()">
                    <option value="ilce">Genel Ä°l Ligi (Åehir Ä°smi)</option>
                    <option value="apartman">Bizim Apartman (A Blok)</option>
                    <option value="site">Mavi Site Sakinleri</option>
                    <option value="okul">AtatÃ¼rk Lisesi 11-B Grubu</option>
                </select>

                <h3>âš¡ Elektrik Verileri (kWh)</h3>
                <div class="fatura-kontrol">
                    <button class="btn-tarat" onclick="simuleFatura('e')">ğŸ“· Fatura Tara</button>
                    <button class="btn-tarat" onclick="simuleFatura('e')">ğŸ”— QR Oku</button>
                </div>
                <div class="uclu">
                    <div><label>1. Ay</label><input type="number" id="e1" placeholder="---"></div>
                    <div><label>2. Ay</label><input type="number" id="e2" placeholder="---"></div>
                    <div><label>GÃ¼ncel</label><input type="number" id="eg" placeholder="Yeni" style="border-color: var(--mavi);"></div>
                </div>

                <h3 style="margin-top:20px;">ğŸ”¥ DoÄŸal Gaz Verileri (mÂ³)</h3>
                <div class="fatura-kontrol">
                    <button class="btn-tarat" onclick="simuleFatura('g')">ğŸ“· Fatura Tara</button>
                    <button class="btn-tarat" onclick="simuleFatura('g')">ğŸ”— QR Oku</button>
                </div>
                <div class="uclu">
                    <div><label>1. Ay</label><input type="number" id="g1" placeholder="---"></div>
                    <div><label>2. Ay</label><input type="number" id="g2" placeholder="---"></div>
                    <div><label>GÃ¼ncel</label><input type="number" id="gg" placeholder="Yeni" style="border-color: var(--mavi);"></div>
                </div>
                <button class="btn btn-ana" onclick="hesapla()">VERÄ°LERÄ° ANALÄ°Z ET & LÄ°GE GÄ°R</button>
            </div>

            <div class="kart" style="margin-top:20px;">
                <h3>ğŸ… KazanÄ±lan Rozetler</h3>
                <div class="rozet-alani">
                    <div class="rozet" id="r1">ğŸŒ± BilinÃ§li BaÅŸlangÄ±Ã§</div>
                    <div class="rozet" id="r2">âš¡ Enerji MuhafÄ±zÄ±</div>
                    <div class="rozet" id="r3">ğŸ”¥ Verimlilik ElÃ§isi</div>
                    <div class="rozet" id="r4">ğŸ… Grup Lideri</div>
                </div>
            </div>
        </div>

        <div class="panel">
            <div id="sonuc-paneli">
                <div id="ikon" style="font-size: 3rem; margin-bottom: 10px;">ğŸ†</div>
                <h2 id="mesajGoster" style="margin: 5px 0;">Analiz Bekleniyor...</h2>
                <h1 id="puanGoster" style="margin: 0; color: var(--uyari);">0 Puan</h1>
            </div>
            <div class="kart">
                <h3 id="ligBaslik">ğŸ† Tasarruf Ligi</h3>
                <div id="ligTablo"></div>
                <div id="userRow" class="lig-item user-sira" style="display:none;">
                    <span id="uName">SÄ°Z</span><span id="uScore"></span>
                </div>
            </div>
            <div class="kart" style="margin-top:20px;">
                <h3>ğŸ Eko-Market (Hemen Harca)</h3>
                <div class="market-grid">
                    <div class="m-kart"><span>ğŸšŒ</span>UlaÅŸÄ±m (50 Pn)<button onclick="harca('UlaÅŸÄ±m', 50)" class="m-btn m-pasif">Yetersiz</button></div>
                    <div class="m-kart"><span>ğŸ¾</span>AskÄ±da Mama (40 Pn)<button onclick="harca('Mama', 40)" class="m-btn m-pasif">Yetersiz</button></div>
                    <div class="m-kart"><span>ğŸ›’</span>Market (200 Pn)<button onclick="harca('Market', 200)" class="m-btn m-pasif">Yetersiz</button></div>
                    <div class="m-kart"><span>âœï¸</span>KÄ±rtasiye (100 Pn)<button onclick="harca('KÄ±rtasiye', 100)" class="m-btn m-pasif">Yetersiz</button></div>
                </div>
            </div>
            <button id="kaydetBtn" class="btn btn-kaydet" onclick="anketeGit()">âœ… ANALÄ°ZÄ° KAYDET VE DEÄERLENDÄ°R</button>
        </div>
    </div>
</div>

<script>
let kullaniciPuani = 0;
let mevcutAdim = 1;

const grupVerileri = {
    "ilce": [{ n: "Ã‡evreci_Muhtar", s: "%24.1 | 241 Pn" }, { n: "Esnaf_HÃ¼seyin", s: "%18.5 | 185 Pn" }, { n: "Ã–ÄŸrenci_AyÅŸe", s: "%12.2 | 122 Pn" }],
    "apartman": [{ n: "YÃ¶netici_AsÄ±m", s: "%31.0 | 310 Pn" }, { n: "Daire_14_Ece", s: "%14.2 | 142 Pn" }, { n: "Emekli_Hasan", s: "%9.5 | 95 Pn" }],
    "site": [{ n: "Site_GÃ¼venlik", s: "%22.4 | 224 Pn" }, { n: "C_Blok_Sakinleri", s: "%19.8 | 198 Pn" }, { n: "Mavi_Papatya", s: "%11.0 | 110 Pn" }],
    "okul": [{ n: "11B_SÄ±nÄ±fÄ±", s: "%29.4 | 294 Pn" }, { n: "Matematik_ZÃ¼mresi", s: "%15.6 | 156 Pn" }, { n: "Okul_KaptanÄ±", s: "%8.2 | 82 Pn" }]
};

window.onload = () => ligiGuncelle();

function sonrakiAdim() {
    mevcutAdim++;
    const n = document.getElementById('adimNo'), b = document.getElementById('adimBaslik'), a = document.getElementById('adimAciklama');
    if(mevcutAdim === 2) {
        n.innerText = "AdÄ±m 2 / 3"; b.innerText = "Tasarruf Et, Puan Kazan! ğŸ†";
        a.innerText = "Fatura verilerinizi elle girin veya 'Fatura Tara' butonuna basarak simÃ¼le edin. Tasarruf oranÄ±nÄ±z Eko-Puan kazandÄ±rÄ±r.";
    } else if(mevcutAdim === 3) {
        n.innerText = "AdÄ±m 3 / 3"; b.innerText = "Ligde YÃ¼ksel ve Harca! ğŸ";
        a.innerText = "KazandÄ±ÄŸÄ±nÄ±z puanlarla marketten Ã¶dÃ¼l alabilir, grup liginde zirveye Ã§Ä±kabilirsiniz. Åimdi baÅŸlayÄ±n!";
    } else { document.getElementById('tutorial').style.display = 'none'; }
}

function ligiGuncelle() {
    const secilen = document.getElementById('grupSecimi').value, liste = document.getElementById('ligTablo'), veriler = grupVerileri[secilen] || grupVerileri["ilce"];
    liste.innerHTML = "";
    veriler.forEach(v => { liste.innerHTML += `<div class="lig-item"><span>${v.n}</span><span>${v.s}</span></div>`; });
    document.getElementById('ligBaslik').innerText = "ğŸ† " + document.getElementById('grupSecimi').options[document.getElementById('grupSecimi').selectedIndex].text;
}

function yeniGrupEkle() {
    const yeni = prompt("Yeni Grup AdÄ±:");
    if(yeni) {
        const s = document.getElementById('grupSecimi'), o = document.createElement("option");
        o.text = yeni; o.value = "ozel"; s.add(o); s.value = "ozel"; ligiGuncelle();
    }
}

function simuleFatura(tip) {
    if(tip === 'e') {
        document.getElementById('e1').value = 650; document.getElementById('e2').value = 610; document.getElementById('eg').value = 540;
    } else {
        document.getElementById('g1').value = 1300; document.getElementById('g2').value = 1250; document.getElementById('gg').value = 1100;
    }
    alert("Ã–rnek veriler baÅŸarÄ±yla yÃ¼klendi!");
}

function hesapla() {
    const e1 = parseFloat(document.getElementById('e1').value) || 0, e2 = parseFloat(document.getElementById('e2').value) || 0, eg = parseFloat(document.getElementById('eg').value) || 0;
    const g1 = parseFloat(document.getElementById('g1').value) || 0, g2 = parseFloat(document.getElementById('g2').value) || 0, gg = parseFloat(document.getElementById('gg').value) || 0;
    if(!eg || !gg) { alert("LÃ¼tfen gÃ¼ncel ay verilerini giriniz!"); return; }
    const eskiOrt = ((e1 + e2) / 2) + ((g1 + g2) / 2);
    const guncel = eg + gg;
    const oran = ((eskiOrt - guncel) / (eskiOrt || 1)) * 100;
    kullaniciPuani = oran > 0 ? Math.floor(oran * 10) : 0;
    document.getElementById('sonuc-paneli').style.display = "block";
    if (oran >= 0) {
        document.getElementById('ikon').innerText = "ğŸ†"; document.getElementById('sonuc-paneli').style.borderColor = "var(--ana)";
        document.getElementById('mesajGoster').innerHTML = `<span style="color:var(--ana)">%${oran.toFixed(1)} Tasarruf!</span>`;
    } else {
        document.getElementById('ikon').innerText = "âš ï¸"; document.getElementById('sonuc-paneli').style.borderColor = "var(--hata)";
        document.getElementById('mesajGoster').innerHTML = `<span style="color:var(--hata)">ArtÄ±ÅŸ: %${Math.abs(oran).toFixed(1)}</span>`;
    }
    document.getElementById('puanGoster').innerText = kullaniciPuani + " Eko-Puan";
    document.getElementById('userRow').style.display = "flex";
    document.getElementById('uName').innerText = (document.getElementById('rumuz').value || "SÄ°Z").toUpperCase();
    document.getElementById('uScore').innerText = (oran >= 0 ? "%" : "+%") + Math.abs(oran).toFixed(1) + " | " + kullaniciPuani + " Pn";
    document.getElementById('r1').classList.add('aktif');
    if(kullaniciPuani > 50) document.getElementById('r2').classList.add('aktif');
    if(kullaniciPuani > 100) document.getElementById('r3').classList.add('aktif');
    const btns = document.querySelectorAll('.m-btn'), maliyetler = [50, 40, 200, 100];
    btns.forEach((btn, i) => {
        if(kullaniciPuani >= maliyetler[i]) { btn.innerText = "Al"; btn.className = "m-btn m-aktif"; btn.disabled = false; }
        else { btn.innerText = "Yetersiz"; btn.className = "m-btn m-pasif"; btn.disabled = true; }
    });
    document.getElementById('kaydetBtn').style.display = "block";
}

function harca(u, b) {
    if(kullaniciPuani >= b) {
        kullaniciPuani -= b; document.getElementById('puanGoster').innerText = kullaniciPuani + " Eko-Puan";
        alert(u + " Kodunuz: EKO-" + Math.floor(Math.random()*9000+1000));
        hesapla();
    }
}

function anketeGit() { window.open(`https://forms.gle/oX2Kg4d3PHeWWUPV6`, "_blank"); }
</script>
</body>
</html>