<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eko-Lig | Final Prototip</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; background: #f8fafc; color: #1e293b; overflow: hidden; }
        .app-container { max-width: 400px; margin: 0 auto; background: white; height: 100vh; display: flex; flex-direction: column; position: relative; }
        .nav-btn { flex: 1; padding: 12px 5px; text-align: center; color: #94a3b8; transition: 0.3s; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 4px; }
        .nav-btn.active { color: #10b981; border-top: 3px solid #10b981; background: #f0fdf4; }
        .nav-btn span { font-size: 10px; font-weight: 800; text-transform: uppercase; }
        .card { background: #f1f5f9; border-radius: 20px; padding: 20px; margin-bottom: 15px; }
        .badge-card { border: 2px solid transparent; transition: 0.4s; }
        .badge-owned { background: #ffffff !important; border-color: #10b981 !important; box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.1); opacity: 1 !important; }
        .hidden { display: none; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        #setup-overlay { position: absolute; inset: 0; background: white; z-index: 100; display: flex; flex-direction: column; padding: 30px; overflow-y: auto; }
    </style>
</head>
<body>

<div class="app-container">
    
    <div id="setup-overlay">
        <h2 class="text-2xl font-black text-emerald-600 mb-2 italic uppercase">HoÅŸ Geldin!</h2>
        <p class="text-xs text-slate-500 mb-6 font-semibold uppercase tracking-tighter">Tasarruf hedefini belirlemek iÃ§in son iki ayÄ±n verilerini girmelisin.</p>
        
        <div class="space-y-6 flex-1">
            <div class="p-4 bg-blue-50 rounded-2xl border border-blue-100">
                <h4 class="text-[10px] font-black text-blue-600 uppercase mb-3"><i class="fa-solid fa-bolt mr-2"></i>Elektrik Baz Verileri (kWh)</h4>
                <div class="grid grid-cols-2 gap-3">
                    <input type="number" id="base-e1" placeholder="1. Ay" class="bg-white p-3 rounded-xl text-sm font-bold outline-none border border-blue-200">
                    <input type="number" id="base-e2" placeholder="2. Ay" class="bg-white p-3 rounded-xl text-sm font-bold outline-none border border-blue-200">
                </div>
            </div>

            <div class="p-4 bg-orange-50 rounded-2xl border border-orange-100">
                <h4 class="text-[10px] font-black text-orange-600 uppercase mb-3"><i class="fa-solid fa-fire mr-2"></i>DoÄŸal Gaz Baz Verileri (mÂ³)</h4>
                <div class="grid grid-cols-2 gap-3">
                    <input type="number" id="base-g1" placeholder="1. Ay" class="bg-white p-3 rounded-xl text-sm font-bold outline-none border border-orange-200">
                    <input type="number" id="base-g2" placeholder="2. Ay" class="bg-white p-3 rounded-xl text-sm font-bold outline-none border border-orange-200">
                </div>
            </div>
        </div>
        
        <button onclick="finishSetup()" class="w-full bg-emerald-600 text-white py-5 rounded-2xl font-black shadow-xl uppercase text-sm tracking-widest mt-6">
            HEDEFLERÄ°MÄ° OLUÅTUR
        </button>
    </div>

    <div class="p-6 flex justify-between items-center border-b bg-white">
        <div>
            <h1 class="text-xl font-black text-emerald-600 italic leading-none">EKO-LÄ°G</h1>
            <p class="text-[9px] text-slate-400 font-bold uppercase tracking-widest mt-1" id="view-title">PANEL</p>
        </div>
        <div class="bg-amber-100 text-amber-700 px-4 py-1.5 rounded-full font-black text-xs border border-amber-200">
            <span id="score-display">0</span> â­ï¸
        </div>
    </div>

    <div id="content" class="flex-1 p-6 overflow-y-auto no-scrollbar pb-24">
        <div id="view-home" class="space-y-6">
            <div class="grid grid-cols-2 gap-3 text-white">
                <div class="bg-blue-600 p-4 rounded-3xl shadow-md">
                    <p class="text-[8px] font-bold uppercase opacity-80">Elek. Ort.</p>
                    <h3 class="text-xl font-black"><span id="avg-e">0</span> <small class="text-[10px]">kWh</small></h3>
                </div>
                <div class="bg-orange-500 p-4 rounded-3xl shadow-md">
                    <p class="text-[8px] font-bold uppercase opacity-80">Gaz Ort.</p>
                    <h3 class="text-xl font-black"><span id="avg-g">0</span> <small class="text-[10px]">mÂ³</small></h3>
                </div>
            </div>

            <div class="space-y-3">
                <h3 class="text-xs font-black text-slate-400 uppercase tracking-widest ml-1">KazanÄ±lan Rozetler</h3>
                <div id="badge-container" class="space-y-3"></div>
                <button onclick="resetApp()" class="w-full text-[9px] text-slate-300 font-bold mt-8 uppercase tracking-widest">Verileri SÄ±fÄ±rla</button>
            </div>
        </div>

        <div id="view-scan" class="hidden space-y-4">
            <div class="bg-blue-50 border border-blue-100 p-5 rounded-3xl">
                <label class="text-[10px] text-blue-500 font-black uppercase mb-2 block italic">Elektrik GiriÅŸi (kWh)</label>
                <input type="number" id="input-elek" placeholder="Yeni Fatura" class="w-full bg-white p-4 rounded-2xl text-xl font-black outline-none border-2 border-transparent focus:border-blue-400">
                <p class="text-[8px] text-blue-400 mt-2 font-bold uppercase">Hedef: <span id="target-e">---</span> kWh altÄ±</p>
            </div>
            
            <div class="bg-orange-50 border border-orange-100 p-5 rounded-3xl">
                <label class="text-[10px] text-orange-500 font-black uppercase mb-2 block italic">DoÄŸal Gaz GiriÅŸi (mÂ³)</label>
                <input type="number" id="input-gaz" placeholder="Yeni Fatura" class="w-full bg-white p-4 rounded-2xl text-xl font-black outline-none border-2 border-transparent focus:border-orange-400">
                <p class="text-[8px] text-orange-400 mt-2 font-bold uppercase">Hedef: <span id="target-g">---</span> mÂ³ altÄ±</p>
            </div>

            <button onclick="processEntry()" class="w-full bg-emerald-600 text-white py-5 rounded-2xl font-black shadow-xl uppercase text-xs tracking-widest mt-2">VERÄ°LERÄ° ANALÄ°Z ET</button>
        </div>

        <div id="view-league" class="hidden space-y-4">
            <div id="league-list" class="space-y-3"></div>
        </div>
    </div>

    <div class="flex border-t bg-white absolute bottom-0 w-full z-10">
        <div onclick="nav('home', 'PANEL')" id="nav-home" class="nav-btn active">
            <i class="fa-solid fa-house text-lg"></i><span>Panel</span>
        </div>
        <div onclick="nav('scan', 'VERÄ° EKLE')" id="nav-scan" class="nav-btn">
            <i class="fa-solid fa-plus-square text-lg"></i><span>Veri Ekle</span>
        </div>
        <div onclick="nav('league', 'LÄ°G')" id="nav-league" class="nav-btn">
            <i class="fa-solid fa-ranking-star text-lg"></i><span>Lig</span>
        </div>
    </div>
</div>

<script>
    let state = JSON.parse(localStorage.getItem('ekoLig_Final_Dual')) || {
        e1: null, e2: null, g1: null, g2: null,
        score: 0, badges: [], setupComplete: false
    };

    const badgeData = [
        {id:'b1', name:'Enerji MimarÄ±', icon:'âš¡ï¸', cat:'elektrik'},
        {id:'b2', name:'Gaz AvcÄ±sÄ±', icon:'ğŸ”¥', cat:'gaz'}
    ];

    const competitors = [
        {n: "Siz", s: 0, me: true},
        {n: "Ali (Yandaki Apt.)", s: 600},
        {n: "Zeynep", s: 450},
        {n: "Eko-Can", s: 280}
    ];

    function finishSetup() {
        const e1 = parseFloat(document.getElementById('base-e1').value);
        const e2 = parseFloat(document.getElementById('base-e2').value);
        const g1 = parseFloat(document.getElementById('base-g1').value);
        const g2 = parseFloat(document.getElementById('base-g2').value);
        
        if(!e1 || !e2 || !g1 || !g2) return alert("LÃ¼tfen tÃ¼m alanlarÄ± doldurun.");
        
        state = {...state, e1, e2, g1, g2, setupComplete: true};
        save();
        document.getElementById('setup-overlay').style.display = 'none';
    }

    function processEntry() {
        const curE = parseFloat(document.getElementById('input-elek').value);
        const curG = parseFloat(document.getElementById('input-gaz').value);
        
        if(!curE && !curG) return alert("Analiz iÃ§in en az bir veri girin.");

        let bonus = 0;
        const avgE = (state.e1 + state.e2) / 2;
        const avgG = (state.g1 + state.g2) / 2;

        if (curE && (avgE - curE) / avgE >= 0.05) {
            bonus += 150;
            if(!state.badges.includes('b1')) state.badges.push('b1');
        }
        if (curG && (avgG - curG) / avgG >= 0.05) {
            bonus += 150;
            if(!state.badges.includes('b2')) state.badges.push('b2');
        }

        if(bonus > 0) {
            state.score += bonus;
            alert(`âœ… BaÅŸarÄ±lÄ±! ${bonus} Puan ve Rozet kazandÄ±n.`);
        } else {
            alert("âŒ Tasarruf oranÄ± %5'in altÄ±nda kaldÄ±. Puan kazanÄ±lamadÄ±.");
        }
        save();
        nav('home', 'PANEL');
    }

    function render() {
        document.getElementById('score-display').innerText = state.score;
        const avgE = ((state.e1 + state.e2) / 2).toFixed(1);
        const avgG = ((state.g1 + state.g2) / 2).toFixed(1);
        
        document.getElementById('avg-e').innerText = state.setupComplete ? avgE : "0";
        document.getElementById('avg-g').innerText = state.setupComplete ? avgG : "0";
        document.getElementById('target-e').innerText = (avgE * 0.95).toFixed(1);
        document.getElementById('target-g').innerText = (avgG * 0.95).toFixed(1);

        const bCont = document.getElementById('badge-container');
        bCont.innerHTML = badgeData.map(b => {
            const owned = state.badges.includes(b.id);
            return `
                <div class="card m-0 flex items-center gap-4 badge-card ${owned ? 'badge-owned' : 'opacity-40'}">
                    <div class="text-3xl">${owned ? b.icon : 'ğŸ”’'}</div>
                    <div><h4 class="text-[10px] font-black uppercase">${b.name}</h4><p class="text-[8px] font-bold text-slate-400 uppercase tracking-tighter">${owned ? 'KazanÄ±ldÄ±' : 'Hedef: -%5'}</p></div>
                </div>`;
        }).join('');

        const lList = document.getElementById('league-list');
        competitors[0].s = state.score;
        const sorted = [...competitors].sort((a,b) => b.s - a.s);
        lList.innerHTML = sorted.map((c, i) => `
            <div class="flex items-center p-4 rounded-2xl border ${c.me ? 'bg-emerald-600 text-white shadow-lg' : 'bg-white border-slate-100'}">
                <span class="w-8 font-black text-xs">#${i+1}</span>
                <span class="flex-1 font-bold text-xs uppercase italic">${c.n}</span>
                <span class="font-black text-xs">${c.s} P</span>
            </div>`).join('');
    }

    function save() { localStorage.setItem('ekoLig_Final_Dual', JSON.stringify(state)); render(); }
    function nav(id, title) {
        ['home', 'scan', 'league'].forEach(v => document.getElementById('view-' + v).classList.add('hidden'));
        ['home', 'scan', 'league'].forEach(v => document.getElementById('nav-' + v).classList.remove('active'));
        document.getElementById('view-' + id).classList.remove('hidden');
        document.getElementById('nav-' + id).classList.add('active');
        document.getElementById('view-title').innerText = title;
    }
    function resetApp() { if(confirm("SÄ±fÄ±rlansÄ±n mÄ±?")) { localStorage.clear(); location.reload(); } }
    window.onload = () => { if(state.setupComplete) document.getElementById('setup-overlay').style.display = 'none'; render(); };
</script>
</body>
</html>